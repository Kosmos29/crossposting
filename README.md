Crossposting (Автопостинг)
============

Разработка решения для автоматической публикации текстов в блоги на CMS Wordpress

Термины:
--------
**Анкор** - (от англ. anchor – якорь, привязка) – это текст ссылки, который располагается между открывающим тегом `<a>` и закрывающим тегом `</a>` <br/>
**Проект** - Совокупность продвигаемых сайтов (шопы, лендинг страницы и тд) и продвигающих сайтов (блоги)<br/>      **Продвигаемый сайт** - Ресурс, чаще всего в форме шопа или лендинг пейдж для реализации товара или вида услуг, на него будут ставится ссылки<br/>
**Продвигающий сайт** - Ресурс (*блог*) в который публикуются тексты со ссылками на продвигаемые сайты<br/>

![Рекламная сеть](https://github.com/andrykrp/crossposting/blob/master/images/crossposting.png?raw=true "Рекламная сеть")

***hint:*** Если посмотреть на модель рекламной сети, то можно понять что сайт может быть одновременно продвигаемым и продвигающим `квадрат A1`

Объединение сайтов в проекты
----------------------------
Нужно сделать возможным создание **проекта** и добавления в него **продвигающих** и **продвигаемых** ресурсов
<br/><br/>
***hint:*** *При добавлении нового сайта пользователю предлагается заполнить **основную** и **дополнительную** информацию в зависимости от того является сайт продвигемым или продвигающим, возможен выбор одновременно и того и того варианта*
<br/><br/>
Для **продвигаемого сайта**:

- Список ссылок на него с возможностью задать процентное соотношение
> 
http://www.siteurl.com - 70%<br/>
http://www.siteurl.com/simple-page.html - 20%<br/>
http://www.siteurl.com/different-page.html -  10%<br/>
http://www.siteurl.com/product1.html -  5%<br/>
http://www.siteurl.com/product2.html -  5<br/>

- Список анкоров для каждой ссылки в отдельности с процентовкой использования для каждого анкора

Все анкоры делятся на **N типов** (~5), для каждого из которых определены свои способы вставки, например:

1. анкор будет вставляться вместе с фразой, т.е. `"текст фразы текст фразы анкор со ссылкой текст фразы"`
1. другой просто между абзацами
1. итд

Тексты для публикации
---------------------
1. Для каждого сайта необходимо автоматически создавать папки из которых будут браться тексты для публикации.
1. После публикации текст повторно использоваться не должен
1. Можно создавать 3 каталога: **Не опубликованое**, **Опубликованое**, **Ожидает проверки**
1. В третьем каталоге текст находится после публикации, пока система не проверит был ли он размещен на сайте и проверит работоспособность размещенной ссылки. (*предложить альтернативу*)

Процесс публикации. Роль "Администратор"
-------------------
1.	Создаётся проект
2.	Из заранее определённого списка, набираем продвигающие ресурсы `(блоги)`
3.	Добавляем ссылки продвигаемых ресурсов с вероятностями `(п. "Объединение сайтов в проекты")`
	*	Необходимо учитывать, что один и тот же ресурс может быть и в списке продвигаемых и продвигающих
4.	Для каждой ссылки продвигаемого ресурса добавляем список анкоров, с вероятностями, у каждого анкора устанавливаем тип из заранее определённого списка`(п. "Объединение сайтов в проекты")`
5.	Добавляем в проект тексты {0,}
6.	Устанавливаем/снимаем отметку об активности проекта

Процесс публикации. Роль "Менеджер"
-------------------
1. Выбирается проект из ранее созданных
2. Добавить тексты

Процесс публикации. Техническая часть
-------------------
Для каждого активного проекта, для текущего продвигающего ресурса:
 
1. Проверяется доступ к его БД
2. Формируется запрос
	* Заполняются все поля для таблицы за исключением тайтла поста и содержания поста
    * Берется не публиковавшийся ранее текст из папки **Не опубликованое**
    * Согласно вероятности выбирается ссылка продвигаемого сайта
    * Согласно вероятности выбирается выбирается анкор для данной ссылки
    * Согласно типу анкора, ссылка ставляется в текст
    * Заполняется тайтл поста
    * Заполняется содержание поста с уже размещенной ссылкой
    * Отправляется запрос в БД для добавления записи в таблицу
3. Текст перемещается в каталог **Ожидает проверки**
4. Идет проверка размещен ли пост и работает ли ссылка
5. После публикации блог перемещается вниз условного списка, т.е. в него будет размещен пост, только после того как все остальные будут использованы, этим достигается `максимальная ширина публикации`
6. Необходимо проверять проверять 2-3 предыдущих поста что бы ссылка и анкор не повторялись в течении 2-3 постов `(уточнить, может ли текст повторяться на разных блогах)`

Дополнения
----------

1.	Реализация системы отчетов
	* Способ доставки: по емайл, выгрузка из админки
	* Данные: урл поста, анкор и адресс сылки добавляются в отчет о поставленных ссылках
	* Формирование: в рамках отдельного проекта, в рамках всех проектов
	* Для способа доставки по емайл, предусмотреть расписание отправки
2.	Возможность копирайтеру самостоятельно добавлять статьи в папки блогов `(п. "Процесс публикации. Роль "Менеджер"")`
3.	Механизм разграничения прав доступа `(исходя из п. "Процесс публикации. Роль 'Администратор'" и "Процесс публикации. Роль 'Менеджер'")`
4.	Формировать список блогов в которых тексты заканчиваются или уже закончились. Критерий: меньше трёх текстов в каталоге **Не опубликованое**

ToDo
-------------------
1.	Предложить/обсудить альтернативу каталогам **Не опубликованое**, **Опубликованое**, **Ожидает проверки**
2.	Уточнить, может ли один текст повторяться на разных блогах
3.	По пунктам обсудить механизм формирования пула публикаций:
	*	Механизм автоматической отправки (расписание/объём/необходимость)
	*	Механизм ручной отправки (входные данные для публикации, необходимо ли указывать объём публикаций)